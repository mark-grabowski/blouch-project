---
title: "Prior Exploration For Simulations"
output: html_notebook
editor_options: 
  chunk_output_type: console
---


Half life - asssume phylogeny is scaled to unit length
```{r}
hl.sims<-rlnorm(n=1000,meanlog=log(0.4),sdlog=1)
plot(density(hl.sims),main="Half-life prior distribution")
abline(v=c(0.1,1))
quantile(hl.sims,probs=c(0.1,0.25,0.5,0.75,0.9))


```


Vy - asssume phylogeny is scaled to unit length
```{r}
vy.sims<-rexp(n=1000,rate=1)
plot(density(vy.sims),main="Vy prior distribution")
quantile(vy.sims,probs=c(0.1,0.5,0.75,0.9))


```


Slope and intercept - simple one level no regimes model
```{r}
library(ggsci)
#Direct Model
#intercept_test<-rnorm(100,stan_sim_data$ols_intercept,0.2)
#slope_test<-rnorm(100,stan_sim_data$ols_slope,0.1)

#Adaptive Model
intercept_test<-rnorm(100,4,0.2)
#slope_test<-rnorm(100,0,0.2)
slope_test<-rlnorm(n=100,meanlog=log(0.4),sdlog=1)

#df<-data.frame(Y=stan_sim_data$Y,X=stan_sim_data$direct_cov)
df<-data.frame(Y=Y,X=X)

names(df)<-c("Y","X")

#slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim1,x=X))+
slope.prior.plot<-ggplot(data=df,aes(y=Y,x=X))+  
  geom_point()+
  geom_abline(intercept=intercept_test,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Trait 1") + xlab("Trait 2")+
  scale_color_npg()

slope.prior.plot
```

slope and intercept - Two Xs
```{r}
library(ggsci)
#Direct Model
#intercept_test<-rnorm(100,stan_sim_data$ols_intercept,0.2)
#slope_test<-rnorm(100,stan_sim_data$ols_slope,0.1)

#Adaptive Model
intercept_test<-rnorm(100,4,0.2)
slope_test<-rnorm(100,0,0.2)

df<-data.frame(Y=Y,X=Xs)

#slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim1,x=X))+
slope.prior.plot<-ggplot(data=df,aes(y=Y,x=X.1))+  
  geom_point()+
  geom_abline(intercept=intercept_test,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Trait 1") + xlab("Trait 2")+
  scale_color_npg()

slope.prior.plot
#slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim1,x=X))+
slope.prior.plot<-ggplot(data=df,aes(y=Y,x=X.2))+  
  geom_point()+
  geom_abline(intercept=intercept_test,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Trait 1") + xlab("Trait 3")+
  scale_color_npg()

slope.prior.plot

```



Slope and intercept - simple one level regime model
```{r}
library(ggsci)
#Direct Model
#intercept_test<-rnorm(100,stan_sim_data$ols_intercept,0.2)
#slope_test<-rnorm(100,stan_sim_data$ols_slope,0.1)

#Adaptive Model
intercept_test<-rnorm(100,stan_sim_data$ols_intercept,0.1)
slope_test<-rnorm(100,stan_sim_data$ols_slope,0.1)


#df<-data.frame(Y=stan_sim_data$Y,X=stan_sim_data$direct_cov)
df<-data.frame(Y=stan_sim_data$Y,X=stan_sim_data$random_cov)

names(df)<-c("Y","X")

#slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim1,x=X))+
slope.prior.plot<-ggplot(data=df,aes(y=Y,x=X))+  
  geom_point()+
  geom_abline(intercept=intercept_test,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Trait 1") + xlab("Trait 2")+
  scale_color_npg()

slope.prior.plot
```


Multilevel model - Normal Y data
```{r}
#beta_raw<-rnorm(100,0,1)
beta_bar<-rnorm(100,stan_sim_data$ols_intercept,0.05)
sd_beta<-rexp(100,7)
beta<-rnorm(100,beta_bar,sd_beta)
slope_test<-rnorm(100,stan_sim_data$ols_slope,0.05)

df<-data.frame(Y=stan_sim_data$Y,X=stan_sim_data$direct_cov)
names(df)<-c("Y","X")

#slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim1,x=X))+
slope.prior.plot<-ggplot(data=df,aes(y=Y,x=X))+  
  geom_point()+
  geom_abline(intercept=beta,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Trait 1") + xlab("Trait 2")+
  scale_color_npg()

slope.prior.plot
```


Mean Centered Y
```{r}
intercept_test<-rt(100,4)
#slope_test<-rnorm(100,ols.slope,0.5)
slope_test<-rnorm(100,stan_sim_data$ols_slope,0.3)

slope.prior.plot<-ggplot(data=reg.trdata$dat,aes(y=Sim.MC1,x=bodycentered))+
  geom_point()+
  geom_abline(intercept=intercept_test,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("log Neocortex Area (mm2)") + xlab("log Brain Mass (g)")+
  scale_color_npg()

slope.prior.plot
library(ggsci)
```


Centered - Mean Centered Y data
```{r Explore Priors 2}
#beta_raw<-rnorm(100,0,1)
beta_raw<-rt(100,1)
#beta_bar<-rnorm(100,stan_sim_data$ols_intercept,0.5)
sd_beta<-rexp(100,1)

beta<-rnorm(100,beta_bar,sd_beta)

slope_test<-rnorm(100,stan_sim_data$ols_slope,0.25)

regression.prior.plot<-ggplot(data=ruminant.trdata$dat,aes(y=Sim.MC1,x=bodycentered))+
  geom_point()+
  geom_abline(intercept=beta,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Simulated log Neocortex Area (mm2)") + xlab("log Body Mass (g)")+
  scale_color_npg()

regression.prior.plot
```

Multilevel Optima non-centered Y not mean standardize
```{r}
#beta_raw<-rnorm(100,0,1)
beta_raw<-rt(100,2)
sd_beta<-rexp(100,1)
beta_bar<-rnorm(100,stan_sim_data$ols_intercept,0.5)
beta<- beta_bar + sd_beta * beta_raw

slope_test<-rnorm(100,stan_sim_data$ols_slope,0.25)

regression.prior.plot<-ggplot(data=ruminant.trdata$dat,aes(y=Sim1,x=bodycentered))+
  geom_point()+
  geom_abline(intercept=beta,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Simulated log Neocortex Area (mm2)") + xlab("log Body Mass (g)")+
  scale_color_npg()

regression.prior.plot
```

Multilevel Optima non-centered Y mean standardized
```{r}
#beta_raw<-rnorm(100,0,1)
beta_raw<-rt(100,2)
sd_beta<-rexp(100,1)
beta_bar<-rt(100,2)
beta<- beta_bar + sd_beta * beta_raw

slope_test<-rnorm(100,stan_sim_data$ols_slope,0.25)

regression.prior.plot<-ggplot(data=ruminant.trdata$dat,aes(y=Sim.MC1,x=bodycentered))+
  geom_point()+
  geom_abline(intercept=beta,slope=slope_test,alpha=0.25)+
  theme_bw()+
  ggtitle("Priors for Intercept and Slope")+
  ylab("Simulated log Neocortex Area (mm2)") + xlab("log Body Mass (g)")+
  scale_color_npg()

regression.prior.plot
```

